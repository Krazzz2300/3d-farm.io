<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Главная</title>
<style>
body {margin:0;background:#1e1e1e;color:#fff;font-family:Arial,sans-serif;}
.container {display:flex;flex-wrap:wrap;gap:24px;padding:16px;}
.printer-block {background:#2a2a2a;border-radius:40px;width:48%;padding:16px;box-sizing:border-box;display:flex;flex-direction:column;align-items:center;position:relative;}
.printer-photo {width:100%;border-radius:7px;object-fit:contain;}
.printer-name {margin-top:12px;font-size:20px;font-weight:bold;display:flex;align-items:center;justify-content:center;gap:8px;}
.color-indicator {width:16px;height:16px;border-radius:50%;background:red;}
.progress-bar-bg {width:100%;height:12px;background:#444;border-radius:6px;margin-top:12px;overflow:hidden;}
.progress-bar {height:100%;width:0%;background:#4caf50;transition:width 0.3s;}
.printing-name {margin-top:8px;font-size:16px;opacity:0.85;}
</style>
</head>
<body>

<div class="container">
  <div class="printer-block" onclick="openPrinterPage(1)">
    <img src="foto/1.png" alt="Bambu Lab A1" class="printer-photo">
    <div class="printer-name">Принтер 1 <div class="color-indicator" id="color-1"></div></div>
    <div class="progress-bar-bg"><div class="progress-bar" id="progress-1"></div></div>
    <div class="printing-name" id="printing-1">—</div>
  </div>
</div>

<script>
function openPrinterPage(id){ location.href = "printer.html?id="+id; }

// === Данные принтера ===
function getPrinterData(){
  return JSON.parse(localStorage.getItem("printerData")) || {
    status:"idle",
    printName:"",
    totalSeconds:0,
    startTime:0,
    endTime:0,
    color:"red"
  };
}

function savePrinterData(data){ localStorage.setItem("printerData",JSON.stringify(data)); }

function updateUI(){
  let p = getPrinterData();
  let elapsed=0, percent=0;
  if(p.status==="printing") elapsed=Math.floor((Date.now()-p.startTime)/1000);
  percent = p.totalSeconds?Math.floor((elapsed/p.totalSeconds)*100):0;
  document.getElementById("progress-1").style.width = percent+"%";
  document.getElementById("printing-1").textContent = p.printName || "—";
  document.getElementById("color-1").style.background = p.color || "red";
}
setInterval(updateUI,500);
updateUI();
</script>

</body>
</html>
